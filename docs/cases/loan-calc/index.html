<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Требования — Калькулятор кредита</title>
</head>
<body>
    <h1>Требования — Калькулятор кредита</h1>
    <div>
        <a href="v01/" target="_blank">Открыть калькулятор</a>
    </div>
    <pre>
Создай одностраничное веб-приложение "Калькулятор кредита" с использованием HTML, CSS и JavaScript (без серверной части).
Страница содержит два блока: блок ввода параметров и блок результатов, которые сменяют друг друга.
Подходит для автоматизированного тестирования с использованием Selenium/Selenide.
---
### FR - Functional requirements - Функциональные требования:

### СТРУКТУРА СТРАНИЦЫ

FR-01 – Страница калькулятора содержит два основных блока:
    • Блок ввода параметров кредита
    • Блок результатов расчёта

FR-02 – Блок ввода параметров содержит:
    • Заголовок "Калькулятор кредита"
    • Поле для ввода суммы кредита (placeholder="100000")
        - Подпись: "Сумма кредита, руб."
        - Подсказка: "Введите сумму от 1000 до 10000000 рублей"
    • Поле для ввода срока кредита в месяцах (placeholder="12")
        - Подпись: "Срок кредита, месяцев"
        - Подсказка: "Введите срок от 1 до 360 месяцев"
    • Поле для ввода процентной ставки годовых (placeholder="15.5")
        - Подпись: "Процентная ставка, % годовых"
        - Подсказка: "Введите ставку в процентах: от 0.01 до 100"
    • Переключатель для выбора типа платежа:
        - "Аннуитетный" (равные платежи)
        - "Дифференцированный" (уменьшающиеся платежи)
    • Кнопка "Рассчитать"
    • Кнопка "Очистить"

FR-03 – Валидация данных:
    • Валидация происходит только при нажатии кнопки "Рассчитать"
    • Если валидация не пройдена хотя бы для одного поля, расчет не начинается
    • Сообщения об ошибках очищаются сразу при изменении значения в поле
    • Допустимые значения и форматы:
        - Сумма кредита: целые числа от 1000 до 10000000 включительно
        - Срок кредита: целые числа от 1 до 360 включительно  
        - Процентная ставка: числа от 0.01 до 100 включительно, 
            только точка в качестве десятичного разделителя, допустима точность до 2 десятичных знаков
            Недопустимые форматы: запятая в качестве разделителя, более 2 знаков после точки, 
            значения вне диапазона [0.01, 100], буквы, символы, пустые поля.
    • Недопустимые форматы (пробелы, запятые, буквы, символы, пустые поля) приводят к ошибке валидации
    • При ошибке валидации текст подсказки под полем заменяется на текст ошибки: 
        "Ошибка: " + исходный текст подсказки (например: "Ошибка: Введите сумму от 1000 до 10000000 рублей")
        и становится красным с увеличенным шрифтом (например, 1.1em), 
        тем самым заменяя собой отдельное сообщение об ошибке.
    • После исправления значения в поле текст подсказки возвращается к исходному (неошибочному), 
        и стиль возвращается к нормальному.

FR-04 – Блок результатов содержит:
    Все поля в блоке результатов отображаются в виде текстовых элементов (не редактируемых полей ввода)
    Для отображения числовых результатов используются элементы span, div или p с соответствующими подписями
    • Заголовок "Результаты расчёта"
    • Параметры кредита:
        - Сумма кредита
        - Срок кредита (в месяцах)
        - Процентная ставка (% годовых)
        - Тип платежа
    • Для аннуитетных платежей: поле "Ежемесячный платёж"
    • Для дифференцированных платежей: 
        - Поле "Первый платёж"
        - Поле "Последний платёж"
        - Текст "Платежи уменьшаются каждый месяц. Детальную информацию смотрите в графике платежей"
    • Поле "Переплата по кредиту"  
    • Поле "Общая сумма выплат"
    • Кнопку "Открыть график платежей"
    • Кнопку "Выполнить новый расчёт"

### НАЧАЛЬНОЕ СОСТОЯНИЕ

FR-05 – При открытии страницы:
    • Все поля ввода пустые
    • Ошибки не отображаются
    • Выбран аннуитетный тип платежа по умолчанию
    • Блок ввода параметров отображается
    • Блок результатов скрыт

FR-06 – При нажатии кнопки "Очистить":
    • Все поля ввода и сообщения об ошибках очищаются
    • Блок ввода параметров остается видимым
    • Блок результатов остается скрытым

### ПРОЦЕСС РАСЧЕТА И ПЕРЕКЛЮЧЕНИЕ БЛОКОВ

FR-07 – При нажатии кнопки "Рассчитать" на корректных данных:
    При открытии модального окна фон затемняется, и взаимодействие с ним блокируется до закрытия окна.
    • Все интерактивные элементы блока ввода параметров становятся недоступными
    • Затемнение фона страницы
    • Появляется чётко видимое белое модальное окно по центру экрана
    • В модальном окне отображается:
        - Текст: "Идёт расчёт, подождите..."
        - Прогресс-бар, который заполняется пропорционально времени оставшегося до завершения имитации расчёта
        - Прогресс-бар начинает заполняться сразу после открытия модального окна и достигает 100% в момент завершения расчёта
        - Кнопка "Прервать расчёт" для отмены операции

FR-08 – После завершения расчёта:
    • Модальное окно закрывается
    • Блок ввода параметров скрывается
    • Блок результатов становится видимым
    • В блоке результатов отображаются рассчитанные значения и параметры кредита
    • Введенные данные сохраняются в полях ввода для возможного повторного использования
    После успешного расчета значения из полей ввода сохраняются в этих же полях, но поля становятся недоступными (disabled)
    При нажатии "Выполнить новый расчёт" значения из предыдущего расчета автоматически подставляются обратно в активные поля ввода

FR-09 – При нажатии кнопки "Прервать расчёт":
    • Все введенные данные сохраняются
    • Интерфейс разблокируется
    • Модальное окно закрывается
    • Блок ввода параметров остается видимым
    • Блок результатов остается скрытым

FR-10 – При нажатии кнопки "Выполнить новый расчёт":
    • Блок результатов скрывается
    • Блок ввода параметров становится видимым
    • Все поля ввода разблокируются
    • Сообщения об ошибках очищаются
    • В поля ввода подставляются значения из предыдущего успешного расчета

### ГРАФИК ПЛАТЕЖЕЙ

FR-11 – При нажатии кнопки "Открыть график платежей":
    • Открывается новое окно/вкладка браузера
        Страница графика открывается через window.open() с параметрами, обеспечивающими полноценное окно браузера
    • Страница должна быть оформлена в том же стиле, что и главная страница
        Все CSS-стили главной страницы должны быть полностью скопированы в новое окно через встроенные стили
    • Содержимое нового окна генерируется полностью с помощью JavaScript
    • В новом окне отображается:
        - Всё содержимое блока результатов, кроме кнопки
        - Полная таблица графика платежей

FR-12 – Таблица графика платежей содержит колонки:
    • Месяц (целое число)
    • Ежемесячный платёж (число с двумя знаками после запятой)
    • Основной долг (число с двумя знаками после запятой)
    • Проценты (число с двумя знаками после запятой)
    • Остаток долга (число с двумя знаками после запятой)
    • Максимальное количество строк - точно по числу месяцев из срока кредита
    • Таблица должна быть читаемой (рамки, выравнивание, заголовки)  

### РАСЧЕТНЫЕ ФОРМУЛЫ И ФОРМАТИРОВАНИЕ

FR-13 – Формулы расчета:
    • Аннуитетный платеж: A = P * (r * (1 + r)^n) / ((1 + r)^n - 1)
    • Дифференцированный платеж: 
        Основной платёж = P / n
        Проценты за месяц = (P - ((P / n) * (m - 1))) * r
        Ежемесячный платёж = Основной платёж + Проценты за месяц
    где P — сумма кредита, n — количество месяцев, r — месячная ставка (годовая ставка / 12 / 100), m — номер месяца
    • Все расчеты округляются до двух знаков после запятой по арифметическим правилам

FR-14 – Форматирование чисел:
    • Все числовые значения в результатах отображаются с точностью до двух десятичных знаков
    • В качестве десятичного разделителя используется точка
    • Все числа отображаются в непрерывном формате без разделителей разрядов (тысяч, миллионов и т.д.)
    В результатах расчета (ежемесячный платёж, переплата, общая сумма выплат и т.д.) числа отображаются с 2 знаками после запятой
    В исходных параметрах (сумма кредита, срок, ставка) числа отображаются в том же формате, в котором были введены, но проходят валидацию на соответствие требуемому формату

### ВИЗУАЛЬНОЕ ОФОРМЛЕНИЕ

FR-15 – Визуальное оформление состояний элементов:
    • Поля с ошибками ввода должны быть четко выделены (красное выделение)
    • Поля без ошибок должны иметь стандартное оформление (серая рамка)
    • Неактивные элементы визуально затемнены и не реагируют на наведение курсора
    • Блоки должны иметь четкое визуальное разделение

---
### ALR - Autotesting Learning Requirements - Требования для обучения автотестированию:

ALR-01 – Для упрощения базовой автоматизации, следующие элементы должны иметь уникальные id или class:
ALR-01-01 – Поле ввода "Сумма кредита": Числовое поле ввода с id="amount"
ALR-01-02 – Поле ввода "Срок кредита в месяцах": Числовое поле ввода с id="term"
ALR-01-03 – Поле ввода "Процентная ставка годовых": Числовое поле ввода с id="rate"
ALR-01-04 – Кнопка "Рассчитать": Кнопка с id="calculate-btn"
ALR-01-05 – Кнопка "Очистить": Кнопка с id="clear-btn"
ALR-01-06 – Кнопка "Выполнить новый расчёт": Кнопка с id="new-calculation-btn"
ALR-01-07 – Кнопка "Открыть график платежей": Кнопка с id="show-schedule-btn"
ALR-01-08 – Блок ввода параметров: Контейнер с id="input-container"
ALR-01-09 – Блок результатов: Контейнер с id="results-container"

ALR-02 – Для отработки навыков поиска через XPath, следующие элементы не должны иметь id или class:
ALR-02-01 – Переключатель "Аннуитетный": Переключатель (radio) с значением "annuity"
  Способ распознавания: //input[@type='radio' and @value='annuity']
ALR-02-02 – Переключатель "Дифференцированный": Переключатель (radio) с значением "diff"
  Способ распознавания: //input[@type='radio' and @value='diff']
ALR-02-03 – Результат "Ежемесячный платёж": Текстовое поле или элемент с результатом
  Способ распознавания: //p[contains(text(), 'Ежемесячный платёж')]/span
ALR-02-04 – Результат "Переплата по кредиту": Текстовое поле или элемент с результатом
  Способ распознавания: //p[contains(text(), 'Переплата по кредиту')]/span
ALR-02-05 – Результат "Общая сумма выплат": Текстовое поле или элемент с результатом
  Способ распознавания: //p[contains(text(), 'Общая сумма выплат')]/span

ALR-03 – Для отработки работы с коллекции элементов, следующие элементы должны иметь дублированные class:
ALR-03-01 – Сообщения об ошибками под полями ввода: Элемент с классом "error"
  Способ распознавания: driver.findElements(By.className("error")) → фильтровать по тексту

ALR-04 – Для отработки навыков работы с явными ожиданиями:
ALR-04-01 – При нажатии кнопки "Рассчитать" система имитирует случайную задержку от 1 до 10 секунд перед отображением результатов
    Задержка имитируется с помощью setTimeout с рандомным значением от 1000 до 10000 миллисекунд
ALR-04-02 – Прогресс-бар в модальном окне должен равномерно заполняться за это время

ALR-05 – Для отработки работы с динамическими элементами:
ALR-05-01 – Блоки должны динамически скрываться/появляться в зависимости от состояния расчета

ALR-06 – Для отработки работы с новыми окнами:
ALR-06-01 – Окно с графиком платежей должно открываться в новом окне/вкладке браузера
ALR-06-02 – Тесты должны уметь переключаться между окнами для проверки графика платежей
    </pre>
</body>
</html>