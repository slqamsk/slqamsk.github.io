<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Пиццерия - Оформление заказа</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
            max-width: 1000px;
            margin: 0 auto;
        }
        h1, h2 {
            color: #2c3e50;
            text-align: center;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }
        .card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            width: 220px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
        }
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }
        .btn:hover {
            background: #2980b9;
        }
        .notification-area {
            height: 60px;
            margin: 20px 0;
            padding: 10px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .notification {
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 5px;
        }
        .info-notification {
            background: #e8f5e9;
            color: #2e7d32;
        }
        .error-notification {
            background: #ffebee;
            color: #c62828;
        }
        .cart {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .cart-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .quantity-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            font-weight: bold;
        }
        .quantity-btn:hover {
            background: #e0e0e0;
        }
        .order-info {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }
        .order-form {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .total-price {
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            text-align: right;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        .order-btn {
            background: #2ecc71;
        }
        .order-btn:hover {
            background: #27ae60;
        }
        .clear-btn {
            background: #e74c3c;
        }
        .clear-btn:hover {
            background: #c0392b;
        }
        .price {
            color: #e74c3c;
            font-weight: bold;
            margin: 5px 0;
        }
        .unavailable {
            opacity: 0.6;
            position: relative;
        }
        .unavailable::after {
            content: "Нет в наличии";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            background: rgba(231, 76, 60, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 14px;
        }
        .pizza-of-the-day {
            border: 2px solid #f39c12;
            background: linear-gradient(135deg, #fffaf0, #fff5e6);
        }
        .pizza-of-the-day-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #f39c12;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .discount-price {
            color: #e74c3c;
            font-weight: bold;
        }
        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 14px;
            margin-left: 5px;
        }
        .discount-text {
            color: #27ae60;
            font-weight: bold;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>Пиццерия "Итальянский уголок"</h1>
    <div>
        <h3>Истинный вкус Италии в вашем городе!</h3>
        <p>Попробуйте наши хиты: <strong>Маргарита</strong>, <strong>Пепперони</strong>, <strong>Гавайская</strong>, <strong>Четыре сыра</strong> и <strong>Вегетарианская</strong>. А также новые: <strong>Карбонара</strong> с нежным беконом, <strong>Мясная</strong> для настоящих гурманов и <strong>Трюфельная</strong> для особых случаев.</p>
        <h3>Готовим с душой в дровяной печи</h3>
        <p>Тонкое тесто, свежайшие продукты и секретные рецепты — вот наш секрет идеальной пиццы.</p>
    </div>
    
    <div class="container" id="menu-container">
        <!-- Карточки пиццы будут создаваться через JavaScript -->
    </div>

    <div class="notification-area" id="notification-area">
        <!-- Здесь будет только одно сообщение -->
    </div>

    <div class="cart">
        <h2>Ваша корзина</h2>
        <div id="cart-items">
            <p>Корзина пуста</p>
        </div>
        
        <div class="total-price" id="total-price">
            Итого: 0 ₽
        </div>
        
        <div class="order-form">
            <div class="form-group">
                <label for="customer-name">Ваше имя:</label>
                <input type="text" id="customer-name" placeholder="Иван Иванов">
            </div>
            
            <div class="form-group">
                <label for="customer-email">Ваш email:</label>
                <input type="email" id="customer-email" placeholder="ivan@example.com">
            </div>
            
            <div class="action-buttons">
                <button class="btn clear-btn" id="clear-cart">Очистить корзину</button>
                <button class="btn order-btn" id="place-order">Заказать</button>
            </div>
        </div>

        <div class="order-info" id="order-info">
            <!-- Здесь будет информация о заказе -->
        </div>
    </div>

    <script>
        // Данные о пиццах
        const pizzaData = [
            {
                name: "Маргарита",
                description: "Томатный соус, моцарелла, базилик",
                price: 450,
                available: "Y" // Доступна - отображается и можно добавить в корзину
            },
            {
                name: "Пепперони",
                description: "Томатный соус, моцарелла, пепперони",
                price: 550,
                available: "Y" // Доступна - отображается и можно добавить в корзину
            },
            {
                name: "Гавайская",
                description: "Томатный соус, моцарелла, курица, ананас",
                price: 500,
                available: "Y" // Доступна - отображается и можно добавить в корзину
            },
            {
                name: "Четыре сыра",
                description: "Сливочный соус, моцарелла, пармезан, дор блю, чеддер",
                price: 600,
                available: "Y" // Доступна - отображается и можно добавить в корзину
            },
            {
                name: "Вегетарианская",
                description: "Томатный соус, моцарелла, перец, грибы, оливки, кукуруза",
                price: 500,
                available: "Y" // Недоступна - отображается серой, но нельзя добавить
            },
            {
                name: "Карбонара",
                description: "Сливочный соус, моцарелла, бекон, яйцо, пармезан",
                price: 580,
                available: "H" // Скрыта - не отображается в меню вообще
            },
            {
                name: "Мясная",
                description: "Томатный соус, моцарелла, пепперони, ветчина, бекон, курица",
                price: 650,
                available: "Y" // Доступна - отображается и можно добавить в корзину
            },
            {
                name: "Трюфельная",
                description: "Сливочный соус, моцарелла, трюфельное масло, грибы, пармезан",
                price: 750,
                available: "N" // Скрыта - не отображается в меню вообще
            },
            {
                name: "Диабло",
                description: "Острый томатный соус, моцарелла, салями, перец халапеньо, чили",
                price: 570,
                available: "H" // Скрыта - не отображается в меню вообще
            }
        ];

        // Пиццы, которые никогда не могут быть пиццей дня
        const excludedFromDaily = ["Маргарита", "Четыре сыра", "Вегетарианская"];

        // Выбираем случайную пиццу дня из доступных, исключая запрещенные
        function getPizzaOfTheDay() {
            const availablePizzas = pizzaData.filter(pizza => 
                pizza.available === "Y" && !excludedFromDaily.includes(pizza.name)
            );
            
            if (availablePizzas.length === 0) return null;
            
            const randomIndex = Math.floor(Math.random() * availablePizzas.length);
            return availablePizzas[randomIndex];
        }

        const pizzaOfTheDay = getPizzaOfTheDay();

        // Создаем объект prices для обратной совместимости (только для доступных пицц)
        const prices = {};
        pizzaData.forEach(pizza => {
            if (pizza.available === "Y") {
                // Для пиццы дня используем цену со скидкой
                if (pizzaOfTheDay && pizza.name === pizzaOfTheDay.name) {
                    prices[pizza.name] = Math.round(pizza.price * 0.9);
                } else {
                    prices[pizza.name] = pizza.price;
                }
            }
        });

        const cart = {};
        const notificationArea = document.getElementById('notification-area');
        const cartItemsEl = document.getElementById('cart-items');
        const totalPriceEl = document.getElementById('total-price');
        const orderInfoEl = document.getElementById('order-info');
        const clearBtn = document.getElementById('clear-cart');
        const orderBtn = document.getElementById('place-order');
        const menuContainer = document.getElementById('menu-container');

        // Функция для создания карточек меню
        function createMenuCards() {
            menuContainer.innerHTML = ''; // Очищаем контейнер
            
            pizzaData.forEach(pizza => {
                // Показываем только пиццы с available: "Y" или "N"
                if (pizza.available === "Y" || pizza.available === "N") {
                    const isPizzaOfTheDay = pizzaOfTheDay && pizza.name === pizzaOfTheDay.name;
                    const discountedPrice = isPizzaOfTheDay ? Math.round(pizza.price * 0.9) : pizza.price;
                    
                    const card = document.createElement('div');
                    card.className = pizza.available === "Y" ? 
                        (isPizzaOfTheDay ? 'card pizza-of-the-day' : 'card') : 
                        'card unavailable';
                    
                    let priceHTML = '';
                    if (isPizzaOfTheDay) {
                        priceHTML = `
                            <div class="price">
                                <span class="discount-price">${discountedPrice} ₽</span>
                                <span class="original-price">${pizza.price} ₽</span>
                            </div>
                            <div class="discount-text">Скидка 10%</div>
                        `;
                    } else {
                        priceHTML = `<div class="price">${pizza.price} ₽</div>`;
                    }
                    
                    card.innerHTML = `
                        ${isPizzaOfTheDay ? '<div class="pizza-of-the-day-badge">Пицца дня!</div>' : ''}
                        <h3 class="pizza-name">${pizza.name}${isPizzaOfTheDay ? ' (пицца дня)' : ''}</h3>
                        <p class="pizza-description">${pizza.description}${isPizzaOfTheDay ? ' Скидка 10%' : ''}</p>
                        ${priceHTML}
                        <button class="btn add-to-cart-btn" ${pizza.available === "N" ? 'disabled' : ''}>
                            ${pizza.available === "Y" ? 'Добавить' : 'Не доступно'}
                        </button>
                    `;
                    menuContainer.appendChild(card);
                }
                // Пиццы с available: "H" не отображаются вообще
            });

            // Добавляем обработчики событий для кнопок "Добавить" (только для доступных пицц)
            document.querySelectorAll('.add-to-cart-btn:not([disabled])').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Находим название пиццы через соседние элементы
                    const card = this.closest('.card');
                    const productName = card.querySelector('.pizza-name').textContent.replace(' (пицца дня)', '').trim();
                    
                    // Находим цену через соседние элементы
                    let productPrice;
                    const priceElement = card.querySelector('.discount-price') || card.querySelector('.price');
                    if (priceElement) {
                        productPrice = parseInt(priceElement.textContent.replace(' ₽', ''));
                    } else {
                        // Если не нашли цену, используем данные из объекта prices
                        productPrice = prices[productName];
                    }
                    
                    // Добавляем товар в корзину
                    cart[productName] = (cart[productName] || 0) + 1;
                    
                    // Показываем сообщение
                    showNotification(`Добавлено: ${productName}`, 'info');
                    
                    // Обновляем корзину
                    updateCart();
                });
            });
        }

        // Инициализация меню
        createMenuCards();

        // Показываем уведомление о пицце дня
        if (pizzaOfTheDay) {
            showNotification(`🍕 Пицца дня: ${pizzaOfTheDay.name} со скидкой 10%!`, 'info');
        }

        // Очистка корзины
        clearBtn.addEventListener('click', function() {
            for (const key in cart) {
                delete cart[key];
            }
            updateCart();
            showNotification('Корзина очищена', 'info');
            orderInfoEl.style.display = 'none';
        });

        // Оформление заказа
        orderBtn.addEventListener('click', function() {
            const name = document.getElementById('customer-name').value;
            const email = document.getElementById('customer-email').value;
            
            if (!name || !email) {
                showNotification('Пожалуйста, заполните все поля!', 'error');
                return;
            }
            
            if (Object.keys(cart).length === 0) {
                showNotification('Корзина пуста!', 'error');
                return;
            }
            
            let orderDetails = `
                <h3>Заказ пиццы оформлен!</h3>
                <p><strong>Имя:</strong> ${name}</p>
                <p><strong>Email:</strong> ${email}</p>
                <p><strong>Выбранные пиццы:</strong></p>
                <ul>
            `;
            
            for (const [name, quantity] of Object.entries(cart)) {
                orderDetails += `<li>${name} - ${quantity} шт. (${prices[name] * quantity} ₽)</li>`;
            }
            
            orderDetails += `
                </ul>
                <p><strong>Общая стоимость:</strong> ${calculateTotal()} ₽</p>
                <p>Спасибо за ваш заказ! Мы свяжемся с вами для подтверждения.</p>
            `;
            
            orderInfoEl.innerHTML = orderDetails;
            orderInfoEl.style.display = 'block';
            showNotification('Заказ успешно оформлен!', 'info');
        });

        // Обновление корзины
        function updateCart() {
            if (Object.keys(cart).length === 0) {
                cartItemsEl.innerHTML = '<p>Корзина пуста</p>';
                totalPriceEl.textContent = 'Итого: 0 ₽';
                return;
            }
            
            let html = '';
            for (const [name, quantity] of Object.entries(cart)) {
                html += `
                <div class="cart-item">
                    <span>${name}</span>
                    <div class="cart-controls">
                        <button class="quantity-btn minus">-</button>
                        <span>${quantity}</span>
                        <button class="quantity-btn plus">+</button>
                    </div>
                </div>
                `;
            }
            cartItemsEl.innerHTML = html;
            totalPriceEl.textContent = `Итого: ${calculateTotal()} ₽`;
            
            // Добавляем обработчики для кнопок +/-
            document.querySelectorAll('.minus').forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    const name = Object.keys(cart)[index];
                    if (cart[name] > 1) {
                        cart[name]--;
                    } else {
                        delete cart[name];
                    }
                    updateCart();
                    showNotification(`Уменьшено количество: ${name}`, 'info');
                });
            });
            
            document.querySelectorAll('.plus').forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    const name = Object.keys(cart)[index];
                    cart[name]++;
                    updateCart();
                    showNotification(`Увеличено количество: ${name}`, 'info');
                });
            });
        }

        // Расчет общей суммы
        function calculateTotal() {
            let total = 0;
            for (const [name, quantity] of Object.entries(cart)) {
                total += prices[name] * quantity;
            }
            return total;
        }

        // Показать временное сообщение (заменяет предыдущее)
        function showNotification(text, type = 'info') {
            notificationArea.innerHTML = '';
            const notification = document.createElement('div');
            notification.className = `notification ${type}-notification`;
            notification.textContent = text;
            notificationArea.appendChild(notification);
        }
    </script>
</body>
</html>
