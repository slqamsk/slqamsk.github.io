<!DOCTYPE html>
<html>
<head>
    <title>ShopList Editor</title>
</head>
<body>
    <h1>Редактор ячейки A1</h1>
    
    <button onclick="getData()">Получить</button>
    <br><br>
    <input type="text" id="cellValue">
    <br><br>
    <button onclick="saveData()">Записать</button>

<script>
    const appUrl = new URLSearchParams(window.location.search).get('appUrl');

    function getData() {
        if (!appUrl) {
            alert('Добавьте в адресную строку параметр ?appUrl=ВАШ_URL');
            return;
        }

        // Принудительно используем HTTPS
        const secureUrl = appUrl.replace('http://', 'https://');
        
        fetch(secureUrl)
            .then(response => response.text())
            .then(data => {
                document.getElementById('cellValue').value = data;
            })
            .catch(error => {
                alert('Ошибка при получении данных: ' + error);
            });
    }

    function saveData() {
        if (!appUrl) {
            alert('Добавьте в адресную строку параметр ?appUrl=ВАШ_URL');
            return;
        }

        const newValue = document.getElementById('cellValue').value;
        const secureUrl = appUrl.replace('http://', 'https://');
        
        fetch(secureUrl, {
            method: 'POST',
            body: newValue
        })
        .then(response => response.text())
        .then(result => {
            alert(result); // Покажем ответ от сервера ("OK: Data saved to A1")
        })
        .catch(error => {
            alert('Ошибка при записи: ' + error);
        });
    }
</script>
</body>
</html>