<!DOCTYPE html>
<html>
<head>
    <title>ShopList Editor</title>
    <style>
        #log {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background: #f9f9f9;
            min-height: 50px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Редактор ячейки A1</h1>
    
    <button onclick="getData()">Получить</button>
    <br><br>
    <input type="text" id="cellValue">
    <br><br>
    <button onclick="saveData()">Записать</button>
    
    <div id="log"></div>

    <script>
        const appUrl = new URLSearchParams(window.location.search).get('appUrl');
        const logElement = document.getElementById('log');

        function logMessage(message) {
            logElement.innerHTML += message + '<br>';
        }

        function getData() {
            if (!appUrl) {
                logMessage('Ошибка: Добавьте параметр ?appUrl=ВАШ_URL в адресную строку');
                return;
            }

            const secureUrl = appUrl.replace('http://', 'https://');
            logMessage('Отправка запроса...');
            
            fetch(secureUrl)
                .then(response => response.text())
                .then(data => {
                    document.getElementById('cellValue').value = data;
                    logMessage('✓ Данные получены: ' + data);
                })
                .catch(error => {
                    logMessage('✗ Ошибка: ' + error);
                });
        }

        function saveData() {
            if (!appUrl) {
                logMessage('Ошибка: Добавьте параметр ?appUrl=ВАШ_URL в адресную строку');
                return;
            }

            const newValue = document.getElementById('cellValue').value;
            const secureUrl = appUrl.replace('http://', 'https://');
            logMessage('Отправка данных...');
            
            fetch(secureUrl, {
                method: 'POST',
                body: newValue
            })
            .then(response => response.text())
            .then(result => {
                logMessage('✓ ' + result);
            })
            .catch(error => {
                logMessage('✗ Ошибка: ' + error);
            });
        }
    </script>
</body>
</html>